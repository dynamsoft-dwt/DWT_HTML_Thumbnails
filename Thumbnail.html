<!DOCTYPE html>
<html>
<head>
    <title>Use Dynamic Web TWAIN to Scan With Thumbnails View</title>
    <script type="text/javascript" src="Resources/dynamsoft.webtwain.config.js"></script>
    <script type="text/javascript" src="Resources/dynamsoft.webtwain.initiate.js"></script>
	<link rel="stylesheet" href="Style/ds.demo.css">
</head>
<body>
<div id="header"> <span onclick="this.parentElement.style.display='none'" class="close">&times;</span>
    <div class="container">
        <div id="headerTop" class="row">
            <div class="ct-lt fl clearfix">
                <div class="logo mr20 fl"> <img src="Style/Images/logo-dwt-56x56.png" alt="Logo"> </div>
                <div class="fl">
                    <div class="linkGroup"> <a target="_blank" class="bluelink ds-font-size-14" href="http://www.dynamsoft.com">Dynamsoft</a><span> / </span> <a target="_blank" class="bluelink" href="http://www.dynamsoft.com/Products/WebTWAIN_Overview.aspx">Dynamic Web TWAIN</a><span> / </span> <a target="_blank" class="bluelink" href="http://www.dynamsoft.com/Downloads/WebTWAIN-Sample-Download.aspx">Code Gallery</a></div>
                    <h1>Scan With Thumbnails View</h1>
                </div>
            </div>
            <div class="ct-rt fr"><a target="_blank" href="http://www.dynamsoft.com/Downloads/WebTWAIN_Download.aspx" class="btn lgBtn bgOrange">Download SDK</a> </div>
        </div>
        <div id="headerBtm" class="row">This sample demonstrates how to use two DWT objects to simulate the Thumbnails view.</div>
    </div>
</div>
<!------------------------------------------> 
<!--The Key Part of the Sample Starts Here-->
<div id="main">
    <div class="container">
		<div class="section p15">
		<select style="width:40%; height:34px;" id="source">
			<option value="" disabled selected>Select A Device</option>
		</select>
		<input type="button" style="width:25%;" class="btn bgBlue mb20 ml4p" value="Scan" onclick="AcquireImage();" />
		<input type="button" style="width:25%;" class="btn bgBlue mb20 ml4p" value="Load" onclick="LoadImage();" />
		</div>
		<div style="display: block; position: absolute;">
			<div id="dwtcontrolContainer" style="float: left; position:relative; margin-right:20px;"></div>
			<div id="dwtcontrolContainerLargeViewer" style="float: left; position:relative;"></div>
		</div>
    </div>
</div>
<!--The Key Part of the Sample Ends Here--> 
<!---------------------------------------->
<div id="footer" style="top:980px;"> <span onclick="this.parentElement.style.display='none'" class="close">&times;</span>
    <div class="container">
        <div id="footerTop" class="row">
            <div class="item contact"> <strong class="fc4">Contact Us</strong>
                <ul>
                    <li><a class="graylink" href="mailto:support@dynamsoft.com">support@dynamsoft.com</a></li>
                    <li><a target="_blank" class="graylink" href="http://www.dynamsoft.com/Support/LiveHelp.aspx">Live Chat</a> / <a target="_blank" class="graylink" href="http://www.dynamsoft.com/Support/LiveHelp.aspx">Submit a Form</a></li>
                    <li>1-604-605-5491 (Toll-Free)</li>
                </ul>
            </div>
            <div class="item features"> <strong class="fc4">Features Demonstrated</strong>
                <ul class="org-li">
                    <li>Scan documents</li>
                    <li>Thumbnails View</li>
                </ul>
            </div>
            <div class="item license"> <strong class="fc4">License Required</strong>
                <ul class="org-li">
                    <li>Core SDK licenses (Windows or Mac or HTML5)</li>
                    <li><a class="bluelink" href="mailto:sales@dynamsoft.com">Contact Dynamsoft Sales</a>&nbsp;<span class="fcBlue"> | </span>&nbsp;<a target="_blank" class="bluelink" href="https://www.dynamsoft.com/Secure/WebTWAIN_BuyIt.aspx">Visit Online Store</a></li>
                </ul>
            </div>
        </div>
        <div id="footerBtm" class="row">
            <div class="ct-lt tc fl">&copy; 2003 - <script>document.write((new Date()).getFullYear());</script> Dynamsoft. All rights reserved. <a href="http://www.dynamsoft.com/PrivacyStatement.aspx">Privacy Statement</a> / <a href="http://www.dynamsoft.com/SiteMap.html">Site Map</a> </div>
            <div class="ct-rt tr fr"><a href="http://www.dynamsoft.com/">Home</a> / <a href="http://www.dynamsoft.com/Purchase/Purchase.aspx">Purchase</a> / <a href="http://www.dynamsoft.com/Support/Support.aspx">Support</a></div>
        </div>
    </div>
</div>
    <script type="text/javascript">
        Dynamsoft.WebTwainEnv.RegisterEvent('OnWebTwainReady', Dynamsoft_OnReady); // Register OnWebTwainReady event. This event fires as soon as Dynamic Web TWAIN is initialized and ready to be used

        var DWObject;

        function Dynamsoft_OnReady() {
            DWObject = Dynamsoft.WebTwainEnv.GetWebTwain('dwtcontrolContainer'); // Get the Dynamic Web TWAIN object that is embeded in the div with id 'dwtcontrolContainer'
            if (DWObject) {
                DWObjectLargeViewer = Dynamsoft.WebTwainEnv.GetWebTwain('dwtcontrolContainerLargeViewer'); // Get the 2nd Dynamic Web TWAIN object that is embeded in the div with id 'dwtcontrolContainerLargeViewer'

                DWObjectLargeViewer.SetViewMode(-1, -1); // When the view mode is set to -1 by -1, the control only shows the current image. No scroll bar is provided to navigate to other images.
                DWObjectLargeViewer.MaxImagesInBuffer = 1; // Set it to hold one image only
                DWObject.SetViewMode(1, 4); // Set the view mode to 1 by 3. In this view mode, when the number of the images in the buffer is larger than 4 (1 x 4), a scroll bar is provide to navigate to other images.
                
                var count = DWObject.SourceCount; // Get how many sources are installed in the system
                for (var i = 0; i < count; i++)
                    document.getElementById("source").options.add(new Option(DWObject.GetSourceNameItems(i), i)); // Add the sources in a drop-down list

                // Register the events
                DWObject.RegisterEvent("OnPostTransfer", Dynamsoft_OnPostTransfer);
                DWObject.RegisterEvent("OnPostLoad", Dynamsoft_OnPostLoad);
                DWObject.RegisterEvent("OnMouseClick", Dynamsoft_OnMouseClick);
            }
        }

        function AcquireImage() {
            if (DWObject) {
                DWObject.SelectSourceByIndex(document.getElementById("source").selectedIndex - 1);
                DWObject.OpenSource();
                DWObject.IfDisableSourceAfterAcquire = true;	// Scanner source will be disabled/closed automatically after the scan.
                DWObject.AcquireImage();
            }
        }

        //Callback functions for async APIs
        function OnSuccess() {
            console.log('successful');
        }

        function OnFailure(errorCode, errorString) {
            alert(errorString);
        }

        function LoadImage() {
            if (DWObject) {
                DWObject.IfShowFileDialog = true; // Open the system's file dialog to load image
                DWObject.LoadImageEx("", EnumDWT_ImageType.IT_ALL, OnSuccess, OnFailure); // Load images in all supported formats (.bmp, .jpg, .tif, .png, .pdf). OnSuccess or OnFailure will be called after the operation
            }
        }

        function Dynamsoft_OnPostTransfer() { // The event OnPostTransfer will get fired after a transfer ends.
            updateLargeViewer();
        }
        function Dynamsoft_OnPostLoad(path, name, type) { // The event OnPostLoad will get fired after the images from a local directory have been loaded into the control.
            updateLargeViewer();
        }
        function Dynamsoft_OnMouseClick() { // The event OnMouseClick will get fired when the mouse clicks on an image.
            updateLargeViewer();
        }
        function updateLargeViewer() {
            DWObject.CopyToClipboard(DWObject.CurrentImageIndexInBuffer); // Copy the current image in the thumbnail to clipboard in DIB format.
            DWObjectLargeViewer.LoadDibFromClipboard(); // Load the image from Clipboard into the large viewer.
        }
    </script>
</body>
</html>
