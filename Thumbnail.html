<!DOCTYPE html>
<html>

<head>
    <title>Use Dynamic Web TWAIN to Scan With Thumbnails View</title>
    <script src="https://unpkg.com/dwt/dist/dynamsoft.webtwain.min.js"> </script>
    <link rel="stylesheet" href="Style/ds.demo.css">
</head>

<body>
    <div id="main">
        <div class="container">
            <div class="section p15">
                <select style="width:40%; height:34px;" id="source">
                    <option value="" disabled selected>Select A Device</option>
                </select>
                <input type="button" style="width:25%;" class="btn bgBlue mb20 ml4p" value="Scan"
                    onclick="AcquireImage();" />
                <input type="button" style="width:25%;" class="btn bgBlue mb20 ml4p" value="Load"
                    onclick="LoadImage();" />
            </div>
            <div style="display: block; position: absolute;">
                <div id="dwtcontrolContainer" style="float: left; position:relative; margin-right:20px;"></div>
                <div id="dwtcontrolContainerLargeViewer" style="float: left; position:relative;"></div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        window.onload = function () {
            Dynamsoft.WebTwainEnv.Load();
        };

        Dynamsoft.WebTwainEnv.RegisterEvent('OnWebTwainReady',
            Dynamsoft_OnReady
        ); // Register OnWebTwainReady event. This event fires as soon as Dynamic Web TWAIN is initialized and ready to be used

        var DWObject;

        function Dynamsoft_OnReady() {
            DWObject = Dynamsoft.WebTwainEnv.GetWebTwain(
                'dwtcontrolContainer'
            ); // Get the Dynamic Web TWAIN object that is embeded in the div with id 'dwtcontrolContainer'
            if (DWObject) {
                DWObject.Width = 182;
                DWObject.Height = 600;
                Dynamsoft.WebTwainEnv.CreateDWTObject("dwtcontrolContainerLargeViewer",
                    function (dwtObject) {
                        DWObjectLargeViewer = dwtObject;
                        if (DWObjectLargeViewer) {
                            DWObjectLargeViewer.Width = 760;
                            DWObjectLargeViewer.Height = 600;
                            DWObjectLargeViewer.SetViewMode(-1, -
                                1
                            ); // When the view mode is set to -1 by -1, the control only shows the current image. No scroll bar is provided to navigate to other images.
                            DWObjectLargeViewer.MaxImagesInBuffer =
                                1; // Set it to hold one image only                
                        }
                    },
                    function (errorString) {
                        console.log(errorString);
                    }
                );
                DWObject.SetViewMode(1,
                    4
                ); // Set the view mode to 1 by 3. In this view mode, when the number of the images in the buffer is larger than 4 (1 x 4), a scroll bar is provide to navigate to other images.

                var count = DWObject.SourceCount; // Get how many sources are installed in the system
                for (var i = 0; i < count; i++)
                    document.getElementById("source").options.add(new Option(DWObject.GetSourceNameItems(i),
                        i)); // Add the sources in a drop-down list

                // Register the events
                DWObject.RegisterEvent("OnPostTransfer", Dynamsoft_OnPostTransfer);
                DWObject.RegisterEvent("OnPostLoad", Dynamsoft_OnPostLoad);
                DWObject.RegisterEvent("OnMouseClick", Dynamsoft_OnMouseClick);
            }
        }

        function AcquireImage() {
            if (DWObject) {
                DWObject.SelectSourceByIndex(document.getElementById("source").selectedIndex - 1);
                DWObject.OpenSource();
                DWObject.IfDisableSourceAfterAcquire =
                    true; // Scanner source will be disabled/closed automatically after the scan.
                DWObject.AcquireImage();
            }
        }

        //Callback functions for async APIs
        function OnSuccess() {
            console.log('successful');
        }

        function OnFailure(errorCode, errorString) {
            alert(errorString);
        }

        function LoadImage() {
            if (DWObject) {
                DWObject.IfShowFileDialog = true; // Open the system's file dialog to load image
                DWObject.LoadImageEx("", EnumDWT_ImageType.IT_ALL, OnSuccess,
                    OnFailure
                ); // Load images in all supported formats (.bmp, .jpg, .tif, .png, .pdf). OnSuccess or OnFailure will be called after the operation
            }
        }

        function Dynamsoft_OnPostTransfer() { // The event OnPostTransfer will get fired after a transfer ends.
            updateLargeViewer();
        }

        function Dynamsoft_OnPostLoad(path, name,
            type
        ) { // The event OnPostLoad will get fired after the images from a local directory have been loaded into the control.
            updateLargeViewer();
        }

        function Dynamsoft_OnMouseClick() { // The event OnMouseClick will get fired when the mouse clicks on an image.
            updateLargeViewer();
        }

        function updateLargeViewer() {
            DWObject.CopyToClipboard(DWObject
                .CurrentImageIndexInBuffer); // Copy the current image in the thumbnail to clipboard in DIB format.
            DWObjectLargeViewer.LoadDibFromClipboard(); // Load the image from Clipboard into the large viewer.
        }
    </script>
</body>

</html>